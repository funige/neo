<!DOCTYPE html>
<html>
<head>
<title>PaintBBS NEO</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> 

<link rel="stylesheet" type="text/css" media="all" href="index.css" />

</head>

<body>

<div id="header" style="height:24px;">
    <div id="back" class="buttonDisabled" style="left:2px;" onclick='back();'>
        <span class="genericon genericon-previous"></span></div>
    <div id="forward" class="buttonDisabled" style="left:34px;" onclick='forward();'>
        <span class="genericon genericon-next"></span></div>
    <div id="edit" class="buttonDisabled" style="right:0;">
        <span class="genericon genericon-edit"></span></div>

    <div style="text-align:center; margin-top: 2px;">
        <select id="target" name="target">
            <option value="www.punyu.net/php/poti_monow">MONO WHITE</option>
            <option value="www.punyu.net/php/poti_cool">COOL TYPE</option>
            <option value="www.punyu.net/php/poti_diary">日記モドキ</option>
            <!-- 
            <option value="jun.2chan.net/oe">ふたば☆ちゃんねる - お絵sql</option>
            <option value="zip.2chan.net/p">ふたば☆ちゃんねる - お絵かき</option>
            <option value="nov.2chan.net/q">ふたば☆ちゃんねる - 落書き</option>
            <option value="cgi.2chan.net/u">ふたば☆ちゃんねる - 落書き裏</option>
            <option value="p.noob.jp/bbsnote">お絵かき掲示板「仮」</option>
            <option value="kazumi386.org:8801/b/jisatsue">虹裏自殺絵　お絵描き掲示板</option>
            <option value="kazumi386.org:8801/b/houti-e">虹裏放置絵　お絵描き掲示板</option>
            <option value="kazumi386.org:8801/b/mugon">虹裏無言絵　お絵描き掲示板</option>
            <option value="kazumi386.org:8801/b/shit-e">虹裏嫉妬絵　お絵描き掲示板</option>
            <option value="kazumi386.org:8801/b/heta-e">虹裏下手絵　お絵描き掲示板</option>
            -->
        </select>
        <input id="post" type="button" value="開く" 
               onclick="load(document.getElementById('target').value);">
        <!--onclick="Neo.painter.submit(document.getElementById('target').value);"-->
    </div>
</div>

<!--
<webview id="webview" src="http://localhost/samplebbs" preload="../dist/neo.js" autosize=on></webview>
-->

<webview id="webview" src="http://www.punyu.net/php/poti_monow" Preload="../dist/neo.js" autosize=on></webview>


<script>
    var {shell} = require('electron');
    var webview = document.getElementById("webview");
    var ipc = require('electron').ipcMain;

    var load = function(url) {
        webview.loadURL("http://" + url);
    };

    var back = function() {
        if (webview.canGoBack()) webview.goBack();
    };

    var forward = function() {
        if (webview.canGoForward()) webview.goForward();
    };

    var updateUI = function() {
        var canGoBack = (webview.canGoBack());
        var canGoForward = (webview.canGoForward());
        var backButton = document.getElementById("back");
        var forwardButton = document.getElementById("forward");
        backButton.className = (canGoBack) ? "button" : "buttonDisabled";
        forwardButton.className = (canGoForward) ? "button" : "buttonDisabled";
    };

    var insertCSS = function() {
        var fs = require('fs');
        fs.readFile('./dist/neo.css', 'utf-8', function(error, data) {
            if (!error) {
                webview.insertCSS(data);
            };
        });
    };

    webview.addEventListener("new-window", function(e) {
        shell.openExternal(e.url);
    });

    webview.addEventListener("ipc-message", function(e) {
        switch (e.channel) {
        case "neo-status":
            document.getElementById("edit").className = "buttonDisabled on";
            break;      
        }
    });

    webview.addEventListener("dom-ready", function(e) {
        updateUI();
        insertCSS();
        document.getElementById("edit").className = "buttonDisabled";

        setTimeout(function() {
    var duplicateInstanceWarning = (navigator.language.indexOf("ja") == 0) ? "アプリと掲示板のNEOが同時に起動しています。アプリ側のNEOを使いたい時は、掲示板の「NEOを使う」設定をオフにしてください。" : "Embeded NEO script is running. If you want to use app&#39;s, disable embeded one before.";
    webview.executeJavaScript("try {document.neo.start(true);} catch (e) {document.getElementById('neoWarning').innerHTML = '" + duplicateInstanceWarning + "';}");
        }, 500);
   });

</script>

</body>
</html>



